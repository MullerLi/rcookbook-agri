[["index.html", "R Cookbook for Agricultural Research 第1 章 關於 1.1 這是什麼? 1.2 為什麼要寫這本書? 1.3 推薦參考資訊", " R Cookbook for Agricultural Research “CHL 臺灣” 2022-12-05 第1 章 關於 這是一本關於統計程式語言 R 的筆記，嘗試用白話文記錄我在 農業試驗研究 上使用的 R 程式語言。 格式受 R cookbook (譯：R錦囊妙計) 啟發 1.1 這是什麼? 這是一個利用 R 撰寫，部屬在Github Page上的電子書。 在這本書中，我將介紹農業研究常用的統計學、試驗設計學、資料繪圖的 R 程式語言。 你不需要具備有寫程式的經驗，但必須： 安裝好R 具備有基礎的試驗設計學知識。 基礎的環境設置和問題，日後再補充上。 這本書直面需要做統計分析的、在臺灣做農業試驗研究的工作人員。 1.2 為什麼要寫這本書? 撰寫程式碼以及使用電腦分析資料是一件困難的事情。尤其在學術訓練過程沒有接觸到統計學的研究者，在資料調查後以及整理後，也不知道如何做好統計分析。 這本書提供的程式碼，或許幫得上他們的忙。 本書的R語言版本： sessionInfo() ## R version 4.2.2 (2022-10-31 ucrt) ## Platform: x86_64-w64-mingw32/x64 (64-bit) ## Running under: Windows 10 x64 (build 19045) ## ## Matrix products: default ## ## locale: ## [1] LC_COLLATE=Chinese (Traditional)_Taiwan.utf8 ## [2] LC_CTYPE=Chinese (Traditional)_Taiwan.utf8 ## [3] LC_MONETARY=Chinese (Traditional)_Taiwan.utf8 ## [4] LC_NUMERIC=C ## [5] LC_TIME=Chinese (Traditional)_Taiwan.utf8 ## ## attached base packages: ## [1] stats graphics grDevices utils datasets methods base ## ## loaded via a namespace (and not attached): ## [1] bookdown_0.30 digest_0.6.30 R6_2.5.1 jsonlite_1.8.3 ## [5] magrittr_2.0.3 evaluate_0.18 stringi_1.7.8 cachem_1.0.6 ## [9] rlang_1.0.6 cli_3.4.1 rstudioapi_0.14 jquerylib_0.1.4 ## [13] bslib_0.4.1 rmarkdown_2.18 tools_4.2.2 stringr_1.4.1 ## [17] xfun_0.34 yaml_2.3.6 fastmap_1.1.0 compiler_4.2.2 ## [21] htmltools_0.5.3 knitr_1.40 sass_0.4.2 1.3 推薦參考資訊 資料科學與R語言 by 長庚大學資管系曾意儒老師。 這是中文版免費的R教科書。 R for Data Science by Hadley Wickham and Garrett Grolemund. Hadley Wickham是RStudio的科學家，也是R語言的耶穌。他寫出來的套件(packages)讓R語言變得更容易使用。這本書用生動有趣的文法介紹資料科學與R的好用套件。 "],["開始之前.html", "第2 章 開始之前… 2.1 第一個R程式碼 2.2 第一張圖", " 第2 章 開始之前… 事前作業： 下載與安裝好R及RStudio R是必須要安裝的 RStudio則是R語言的”整合開發環境 (Integrated Development Environment, IDE)，讓你更舒服地撰寫程式，不是必須。 R就像是英語、RStudio就像是word。 強烈建議安裝RStudio，方便管理你的程式與算好的結果。本書程式碼全部都是在RStudio中寫出來的。 2.1 第一個R程式碼 複製下面程式碼，輸入R的介面中並執行。 這是你的第一個R程式碼！ print(&#39;Hello world!&#39;) ## [1] &quot;Hello world!&quot; 本書會包含程式碼(上方灰框)與執行結果(下方灰框)，你可以直接複製貼上程式碼，在你的R介面中執行，比較看看結果是否相同。 你會發現，R語言是一個像是Google助理一樣的工具，輸入一行指令、返回一行結果，這種類型的程式語言叫做直譯語言（Interpreted Language）。 但是，R程式碼也有可能很多行，譬如下面就是一個很常見到的程式碼，用到條件判斷(if)還有+號連結許多不同函數。 2.2 第一張圖 你可以將下面程式碼複製後，整個貼到你的RStudio介面或是R中執行，畫出你的第一張圖： pkg = c(&#39;magrittr&#39;,&#39;ggplot2&#39;) if ( any(pkg) %in% installed.packages() == TRUE) install.packages(pkg[!pkg %in% rownames(installed.packages())]) invisible(lapply(pkg, library, character.only = TRUE)) ggplot(data = iris, mapping = aes(x = Sepal.Length, y = Petal.Width, color = Species))+ geom_jitter()+ geom_smooth(se=F)+ theme_bw()+ labs(x=&#39;花萼長度(cm)&#39;, y=&#39;花瓣寬度(cm)&#39;, color = &#39;品種&#39;, title = &#39;3種鳶尾花花萼長與花瓣寬線性關係&#39;) 你可能會問，鳶尾花是什麼? 哪來的鳶尾花? 上面的圖中，我使用到的鳶尾花(iris)資料集，是R. A. Fisher在1938年出版的The Use of Multiple Measurements in Taxonomic Problems中使用到的資料集。 這個資料集非常有名，包含有加拿大加斯帕半島採集到的三種鳶尾花品種形態資料。（葉茂生老師說：形不是型！不可以弄錯） 像這樣的資料集有非常多筆已經內建在R程式裡面，他們可以用簡單的指令叫出來。 在後續的程式碼中，可能會用到不同範例資料來討論。 "],["平均值檢定.html", "第3 章 平均值檢定 3.1 利用t檢定比較兩群平均值", " 第3 章 平均值檢定 3.1 利用t檢定比較兩群平均值 在分析實驗結果時，我們最關切的問題，應屬”平均值之間是否有差異”。 假設今天有一個新品種水稻，據研究者說，這個品種相較現有品種而言，有更高的產量(yield)。因此，農民如果種植新品種，最後可以收穫更多更重的稻穀。 這時候，就可以應用t檢定來測試新品種與現有品種產量平均值之間是否有差異，如果發現確實有差異，那就可以說明新品種確實比較”高產”。 3.1.1 產生資料 資料會由亂數產生，下面這個程式碼只要執行一次就好。 # 產生亂數資料 riceYield&lt;-data.frame( &#39;variety&#39; = (rep(c(&#39;A&#39;,&#39;B&#39;),each=10) ), &#39;yield&#39; = c(rnorm(n = 10 , mean = 5000 , sd = 400),rnorm(n=10 , mean = 6500 , sd = 400) )) 現在來看看這筆資料長怎樣： # 查看 前 10筆資料 head(riceYield) ## variety yield ## 1 A 4777.457 ## 2 A 4921.725 ## 3 A 4525.181 ## 4 A 5002.844 ## 5 A 4798.282 ## 6 A 5211.809 # 查看 後 10筆資料 tail(riceYield) ## variety yield ## 15 B 6422.435 ## 16 B 6306.927 ## 17 B 6501.793 ## 18 B 6314.491 ## 19 B 6284.933 ## 20 B 6689.514 在上面使用到的2個函數(function)的意思： head(資料名稱): 查看該資料前6筆的值 tail(資料名稱): 查看該資料後6筆的值 補充 在R中直接輸入「東西的名稱」，而沒有用冒號 ( \" or ' ) 括起來，就會得到「該東西的內容」。例如上述資料集為 “riceYield” ，所以輸入 riceYield 就會連結到該筆資料。 英文字母的大小寫在R程式裡面是不一樣的意思。所以輸入 riceyield 或 Riceyield 或 RiceYield 會跳出錯誤，R會跟你說，它找不到這個東西(object ‘riceyield’ not found)，因為它只認得riceYield。 print(riceyield) ## Error in print(riceyield): 找不到物件 &#39;riceyield&#39; 如果想要查看整筆資料，可以直接輸入資料名稱，或是print(資料名稱) riceYield # 等同於 print(riceYield) ## variety yield ## 1 A 4777.457 ## 2 A 4921.725 ## 3 A 4525.181 ## 4 A 5002.844 ## 5 A 4798.282 ## 6 A 5211.809 ## 7 A 4815.242 ## 8 A 4996.139 ## 9 A 5168.282 ## 10 A 5200.520 ## 11 B 6331.306 ## 12 B 5959.877 ## 13 B 6118.321 ## 14 B 6482.532 ## 15 B 6422.435 ## 16 B 6306.927 ## 17 B 6501.793 ## 18 B 6314.491 ## 19 B 6284.933 ## 20 B 6689.514 3.1.2 兩樣本t檢定 t檢定在R中是這樣執行的： ## ## Welch Two Sample t-test ## ## data: yield by variety ## t = -14.758, df = 17.897, p-value = 1.848e-11 ## alternative hypothesis: true difference in means between group A and group B is not equal to 0 ## 95 percent confidence interval: ## -1598.776 -1200.154 ## sample estimates: ## mean in group A mean in group B ## 4941.748 6341.213 t.test上面有三個指令 第1個指令該筆資料的名稱，這筆資料名是我在自己創造的亂數資料riceYield，所以輸入 data = riceYield 第2個指令和第1個指令中間用 , 相隔 第2個指令是告訴R比較的方式，寫法是 觀測值 ~ 處理名稱，注意這裡觀測值和處理名稱都沒有用冒號框住 第3個指令是樣本是否成對 現在來逐行看報表： t.test(data = riceYield, yield ~ variety, paired = F, conf.level = 0.95) ## ## Welch Two Sample t-test ## ## data: yield by variety ## t = -14.758, df = 17.897, p-value = 1.848e-11 ## alternative hypothesis: true difference in means between group A and group B is not equal to 0 ## 95 percent confidence interval: ## -1598.776 -1200.154 ## sample estimates: ## mean in group A mean in group B ## 4941.748 6341.213 第1行告訴你這個報表是Welch Two Sample t-test (Welch的t檢定是t檢定的一種變形) 第2行: 表示這一筆資料是將yield依照variety分組比較，記得上面我們輸入的 觀測值 ~ 處理名稱 嗎? 重點在第3行，可以看到重要的檢定結果： t : t 值 df :自由度 p-value : 表示本次檢定所得 p 值 p值的表示方式比較特別，用到”e”，e代表10的幾次方： \\(3.639e-08 = 3.639 \\times 10^{-8}\\) 這邊可以看到p值很小，所以棄卻虛無假說：「兩樣本平均值相等」 ( \\(H_0:\\mu_1 - \\mu_2 =0\\) )。 結論：在\\(\\alpha = 0.05\\)時，兩品種產量具顯著差異。顯著水準\\(\\alpha\\)在t.test函數中沒有辦法設定，是這個函數的小缺憾。 3.1.3 產生結果表 "],["parts.html", "第4 章 Parts", " 第4 章 Parts You can add parts to organize one or more book chapters together. Parts can be inserted at the top of an .Rmd file, before the first-level chapter heading in that same file. Add a numbered part: # (PART) Act one {-} (followed by # A chapter) Add an unnumbered part: # (PART\\*) Act one {-} (followed by # A chapter) Add an appendix as a special kind of un-numbered part: # (APPENDIX) Other stuff {-} (followed by # A chapter). Chapters in an appendix are prepended with letters instead of numbers. "],["footnotes-and-citations.html", "第5 章 Footnotes and citations 5.1 Footnotes 5.2 Citations", " 第5 章 Footnotes and citations 5.1 Footnotes Footnotes are put inside the square brackets after a caret ^[]. Like this one 1. 5.2 Citations Reference items in your bibliography file(s) using @key. For example, we are using the bookdown package (Xie 2022) (check out the last code chunk in index.Rmd to see how this citation key was added) in this sample book, which was built on top of R Markdown and knitr (xie2015?) (this citation was added manually in an external file book.bib). Note that the .bib files need to be listed in the index.Rmd with the YAML bibliography key. The RStudio Visual Markdown Editor can also make it easier to insert citations: https://rstudio.github.io/visual-markdown-editing/#/citations References "],["blocks.html", "第6 章 Blocks 6.1 Equations 6.2 Theorems and proofs 6.3 Callout blocks", " 第6 章 Blocks 6.1 Equations Here is an equation. \\[\\begin{equation} f\\left(k\\right) = \\binom{n}{k} p^k\\left(1-p\\right)^{n-k} \\tag{6.1} \\end{equation}\\] You may refer to using \\@ref(eq:binom), like see Equation (6.1). 6.2 Theorems and proofs Labeled theorems can be referenced in text using \\@ref(thm:tri), for example, check out this smart theorem 6.1. Theorem 6.1 For a right triangle, if \\(c\\) denotes the length of the hypotenuse and \\(a\\) and \\(b\\) denote the lengths of the other two sides, we have \\[a^2 + b^2 = c^2\\] Read more here https://bookdown.org/yihui/bookdown/markdown-extensions-by-bookdown.html. 6.3 Callout blocks The R Markdown Cookbook provides more help on how to use custom blocks to design your own callouts: https://bookdown.org/yihui/rmarkdown-cookbook/custom-blocks.html :::: {.center data-latex=&quot;&quot;} ::: {.minipage data-latex=&quot;{.5\\linewidth}&quot;} This paragraph will be centered on the page, and its width is 50% of the width of its parent element. ::: :::: "],["sharing-your-book.html", "第7 章 Sharing your book 7.1 Publishing 7.2 404 pages 7.3 Metadata for sharing", " 第7 章 Sharing your book 7.1 Publishing HTML books can be published online, see: https://bookdown.org/yihui/bookdown/publishing.html 7.2 404 pages By default, users will be directed to a 404 page if they try to access a webpage that cannot be found. If you’d like to customize your 404 page instead of using the default, you may add either a _404.Rmd or _404.md file to your project root and use code and/or Markdown syntax. 7.3 Metadata for sharing Bookdown HTML books will provide HTML metadata for social sharing on platforms like Twitter, Facebook, and LinkedIn, using information you provide in the index.Rmd YAML. To setup, set the url for your book and the path to your cover-image file. Your book’s title and description are also used. This gitbook uses the same social sharing data across all chapters in your book- all links shared will look the same. Specify your book’s source repository on GitHub using the edit key under the configuration options in the _output.yml file, which allows users to suggest an edit by linking to a chapter’s source file. Read more about the features of this output format here: https://pkgs.rstudio.com/bookdown/reference/gitbook.html Or use: ?bookdown::gitbook "],["references.html", "References", " References "],["兩個平均值的檢定.html", "第8 章 兩個平均值的檢定 8.1 虛無假說 8.2 族群變異數已知：z檢定 8.3 t檢定，樣本平均值與常數比較 8.4 兩獨立樣本的 t 檢定 8.5 正統 t 檢定(exact t test)，樣本標準差相同 (計算pooled S) 8.6 近似 t 檢定，族群標準差不同 (計算pooled 自由度) 8.7 小記： 8.8 兩平均值差的信賴區間", " 第8 章 兩個平均值的檢定 8.1 虛無假說 \\(H_0:\\mu_1=\\mu_2\\) \\(H_1 : \\mu_1\\ne\\mu_2\\) \\(\\mu_2\\)可以是常數，或是另一個樣本的平均值 當檢定值ｔ或ｚ &gt; \\(t_{\\frac{\\alpha}{2},n-1}\\)時，reject \\(H_0\\) 當檢定值ｔ或ｚ &lt; \\(t_{\\frac{\\alpha}{2},n-1}\\)時，reject \\(H_0\\) 8.2 族群變異數已知：z檢定 \\[Z = \\frac{\\bar y_1-\\bar y_2} { \\sqrt{\\frac{\\sigma_1^2}{n_1}+\\frac{\\sigma_2^2}{n_2}} }\\] 8.3 t檢定，樣本平均值與常數比較 \\[t_0=\\frac{\\bar y_1-\\mu_0}{\\sqrt{\\frac{S^2}{n}}}\\] 8.4 兩獨立樣本的 t 檢定 8.5 正統 t 檢定(exact t test)，樣本標準差相同 (計算pooled S) 通常要先用F檢定 \\(H_0:\\sigma_1^2=\\sigma_2^2\\) 確定變異數相等，才能用正統 t 檢定 統計檢定量 \\[t_0=\\frac{\\bar y_1-\\bar y_2}{S_p\\sqrt{\\frac{1}{n_1}+\\frac{1}{n_2}}}\\] 自由度 v：\\[v = n_1+n_2-2\\] \\(S_p\\)的計算： \\[S_p = \\frac{(n_1-1)S_1^2+(n_2-1)S_2^2}{n_1+n_2-2}\\] 8.6 近似 t 檢定，族群標準差不同 (計算pooled 自由度) \\(\\sigma_1^2 \\ne \\sigma_2^2\\) * 統計檢定量 * \\[t_0=\\frac{\\bar y_1-\\bar y_2}{\\sqrt{\\frac{S_1^2}{n_1}+\\frac{S_2^1}{n_2}}}\\] * 自由度 v 的計算： \\[v = \\frac{(\\frac{S_1^2}{n_1}+\\frac{S_2^2}{n_2})}{\\frac{(S_1^2/n_1)^2}{n_1-1}+\\frac{(S_2^2/n_1)^2}{n_2-1}}\\] 8.7 小記： 當樣本夠多，一個樣本可以分成兩份均值的樣本，同時接受兩種處理。 進行比較時，可以將兩組樣本觀測值相減，檢定是否為0；或可視為單因子ANOVA。 研究發現，只要兩個樣本的抽樣數相同，使用兩種 t 檢定都可以；不同的時候，再用近似 t 檢定就好 兩種 t 檢定的結論如果不同，相信近似 t 檢定 8.8 兩平均值差的信賴區間 Confidence Interval \\[\\mu_1-\\mu_2=\\bar y_1-\\bar y_2 \\pm t_{\\alpha/2,n_1+n_2-2}\\times S_p\\sqrt{\\frac{1}{n_1}+\\frac{1}{n_2}}\\] "]]
